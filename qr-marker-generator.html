<!DOCTYPE html>
<html>

<head>
    <title>QR Code AR Marker Generator</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .container {
            text-align: center;
        }

        input,
        button {
            padding: 10px;
            margin: 10px;
            font-size: 16px;
        }

        #qrcode {
            margin: 20px 0;
        }

        .instructions {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            text-align: left;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>QR Code AR Marker Generator</h1>

        <div>
            <input type="text" id="urlInput" placeholder="Enter your website URL" style="width: 300px;">
            <button onclick="generateQR()">Generate QR Code</button>
        </div>

        <div id="qrcode"></div>

        <div class="instructions">
            <h3>Instructions:</h3>
            <ol>
                <li>Enter your website URL above (the one hosting your AR experience)</li>
                <li>Click "Generate QR Code"</li>
                <li>Right-click the QR code and save it as "qr-marker.png"</li>
                <li>Print this QR code on paper or display it on screen</li>
                <li>When users scan this QR code with their phone, they'll visit your site</li>
                <li>When they point their camera at this same QR code, the 3D model will appear on it!</li>
            </ol>

            <h3>How it works:</h3>
            <p>This QR code serves a dual purpose:</p>
            <ul>
                <li><strong>Step 1:</strong> Users scan it normally → Opens your AR website</li>
                <li><strong>Step 2:</strong> The website opens camera → Users point camera at the same QR code → 3D
                    model appears on the QR code</li>
            </ul>
        </div>
    </div>

    <script>
        function generateQR() {
            const url = document.getElementById('urlInput').value;
            if (!url) {
                alert('Please enter a URL');
                return;
            }

            // Clear previous QR code
            document.getElementById('qrcode').innerHTML = '';

            try {
                // Try using the qrcode-generator library
                if (typeof qrcode !== 'undefined') {
                    const qr = qrcode(0, 'M');
                    qr.addData(url);
                    qr.make();

                    // Create the QR code as an image
                    const qrImage = qr.createImgTag(4, 8);
                    document.getElementById('qrcode').innerHTML = qrImage;

                    console.log('QR code generated successfully!');
                } else {
                    throw new Error('QR library not loaded');
                }
            } catch (error) {
                console.error('Error generating QR code:', error);
                // Fallback: Use online QR generator
                generateQRFallback(url);
            }
        }

        function generateQRFallback(url) {
            const qrContainer = document.getElementById('qrcode');
            const encodedUrl = encodeURIComponent(url);
            const qrApiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=${encodedUrl}`;

            qrContainer.innerHTML = `
                <img src="${qrApiUrl}" alt="QR Code" style="border: 2px solid #000; padding: 10px; background: white; max-width: 256px;">
                <br>
                <p style="margin-top: 10px;"><strong>Right-click the QR code above and "Save image as..." to download it</strong></p>
                <p>This QR code links to: <code>${url}</code></p>
            `;
        }

        // Auto-generate with example URL
        window.onload = function () {
            // Try to get the current directory URL and point to index.html
            let currentUrl = window.location.href;
            if (currentUrl.includes('qr-marker-generator.html')) {
                currentUrl = currentUrl.replace('qr-marker-generator.html', 'index.html');
            } else {
                // If not, just use the current origin + index.html
                currentUrl = window.location.origin + window.location.pathname.replace(/[^/]*$/, '') + 'index.html';
            }

            document.getElementById('urlInput').value = currentUrl;

            // Small delay to ensure page is fully loaded
            setTimeout(() => {
                generateQR();
            }, 500);
        };
    </script>
</body>

</html>